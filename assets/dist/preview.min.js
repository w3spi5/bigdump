(function(){"use strict";function E(r){var e=r.trim().toUpperCase();return e.startsWith("CREATE TABLE")?"CREATE TABLE":e.startsWith("CREATE DATABASE")?"CREATE DATABASE":e.startsWith("DROP TABLE")?"DROP TABLE":e.startsWith("INSERT")?"INSERT":e.startsWith("UPDATE")?"UPDATE":e.startsWith("DELETE")?"DELETE":e.startsWith("ALTER")?"ALTER":e.startsWith("SET")?"SET":e.startsWith("USE")?"USE":"SQL"}function v(r){var e=E(r);switch(e){case"CREATE TABLE":case"CREATE DATABASE":return"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200";case"DROP TABLE":case"DELETE":return"bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-200";case"INSERT":return"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200";case"UPDATE":case"ALTER":return"bg-amber-100 dark:bg-amber-900/50 text-amber-800 dark:text-amber-200";default:return"bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200"}}function g(r){var e=document.getElementById("previewModal"),n=document.getElementById("previewLoading"),i=document.getElementById("previewError"),d=document.getElementById("previewContent");e.classList.remove("hidden"),n.classList.remove("hidden"),i.classList.add("hidden"),d.classList.add("hidden"),document.getElementById("previewModalTitle").textContent=r,document.getElementById("previewModalSubtitle").textContent="Loading preview...",document.getElementById("previewImportFilename").value=r,fetch("?action=preview&fn="+encodeURIComponent(r)).then(function(t){return t.json()}).then(function(t){if(n.classList.add("hidden"),t.error){i.classList.remove("hidden"),document.getElementById("previewErrorMessage").textContent=t.error;return}document.getElementById("previewModalSubtitle").textContent=t.fileSizeFormatted+(t.isGzip?" (GZip compressed)":""),document.getElementById("previewFileSize").textContent=t.fileSizeFormatted,document.getElementById("previewFileType").textContent=t.isGzip?"GZip":"SQL",document.getElementById("previewLinesCount").textContent=t.linesPreview,document.getElementById("previewQueriesCount").textContent=t.queriesPreview,document.getElementById("tabQueriesCount").textContent=t.queriesPreview,document.getElementById("previewRaw").textContent=t.rawContent;var w=document.getElementById("previewQueries");w.replaceChildren(),t.queries.forEach(function(l,b){var a=document.createElement("div");a.className="bg-gray-50 dark:bg-gray-700 rounded-lg p-4";var s=document.createElement("div");s.className="flex items-center justify-between mb-2";var u=document.createElement("span");u.className="text-xs font-semibold uppercase tracking-wide text-gray-500 dark:text-gray-400",u.textContent="Query "+(b+1);var c=document.createElement("span");c.className="text-xs px-2 py-1 rounded "+v(l),c.textContent=E(l),s.appendChild(u),s.appendChild(c);var m=document.createElement("pre");m.className="text-sm font-mono text-gray-800 dark:text-gray-200 overflow-x-auto whitespace-pre-wrap",m.textContent=l,a.appendChild(s),a.appendChild(m),w.appendChild(a)}),d.classList.remove("hidden"),o("raw")}).catch(function(t){n.classList.add("hidden"),i.classList.remove("hidden"),document.getElementById("previewErrorMessage").textContent="Network error: "+t.message})}function p(r){r&&r.target!==r.currentTarget||document.getElementById("previewModal").classList.add("hidden")}function o(r){var e=document.getElementById("tabRaw"),n=document.getElementById("tabQueries"),i=document.getElementById("previewRaw"),d=document.getElementById("previewQueries");r==="raw"?(e.classList.add("border-blue-500","text-blue-600","dark:text-blue-400"),e.classList.remove("border-transparent","text-gray-500"),n.classList.remove("border-blue-500","text-blue-600","dark:text-blue-400"),n.classList.add("border-transparent","text-gray-500"),i.classList.remove("hidden"),d.classList.add("hidden")):(n.classList.add("border-blue-500","text-blue-600","dark:text-blue-400"),n.classList.remove("border-transparent","text-gray-500"),e.classList.remove("border-blue-500","text-blue-600","dark:text-blue-400"),e.classList.add("border-transparent","text-gray-500"),d.classList.remove("hidden"),i.classList.add("hidden"))}window.BigDump=window.BigDump||{},window.BigDump.previewFile=g,window.BigDump.closePreviewModal=p,window.BigDump.switchPreviewTab=o,window.previewFile=g,window.closePreviewModal=p,window.switchPreviewTab=o})();
